# WOD Wiki Documentation Preferences

Documentation generation settings and patterns for AI assistants working on this codebase.

## Project Configuration

- **Source Path**: .
- **Documentation Format**: Markdown
- **Include Examples**: true
- **Output Location**: ./docs/generated
- **Documentation Style**: comprehensive

## Language & Standards

- **Primary Language**: TypeScript
- **Framework**: React 18+
- **Build System**: Vite
- **Package Manager**: Bun
- **Testing**: Vitest + Playwright

## Documentation Standards

### TypeScript Documentation

- Use TSDoc/JSDoc style comments
- Document all public API surfaces
- Include type information in parameter docs
- Use `@example` tags for code examples
- Document optional parameters with `?` suffix
- Return types should be clearly stated

### Component Documentation

- Document all props with types
- Include usage examples
- Note optional vs required props
- Document context/children patterns
- Show Storybook story references when available

### Function/Method Documentation

- Document parameters with types
- Document return types
- Include example usage
- Note side effects
- Document error conditions
- Include performance considerations where relevant

## Documentation Structure

### Module Documentation

Each major module should have:
1. **Overview** - High-level description
2. **Components/Classes** - Document all exports
3. **Functions/Methods** - Each with full signature
4. **Interfaces** - All public interfaces
5. **Types** - Custom types and enums
6. **Examples** - Practical usage examples
7. **See Also** - Related documentation links

### Code Examples

Guidelines for examples:
- Use real, synthetic but realistic data
- Demonstrate common use cases
- Show error handling where applicable
- Include imports in examples
- Keep examples focused and simple
- Use the actual function signatures from codebase

## Markdown Formatting

- Use `#` for main title
- Use `##` for major sections
- Use `###` for sub-sections
- Use ``` for code blocks with language identifiers
- Use `**` for bold emphasis
- Use `*` for italic emphasis
- Use `|` for tables
- Use `>` for blockquotes
- Use `[` for links and `]` for link text

## Cross-Referencing

- Link related functions/classes using `[Name](#anchor)` format
- Create "See Also" sections with links
- Use relative paths for cross-file links: `[text](file.md#section)`
- Anchor links created automatically from headers (`## Name` creates `#name`)

## Key Patterns

### Error Handling

```typescript
// Pattern 1: Union types for error states
type Result<T> = { success: true; data: T } | { success: false; error: Error };

// Pattern 2: Throwing descriptive errors
if (!value) {
  throw new Error('Value is required for operation');
}
```

### React Patterns

```typescript
// Component props with interfaces
interface Props {
  value: string;
  onChange: (value: string) => void;
  readonly?: boolean;
}

// Custom hooks for logic reuse
const useCustomHook = (initialValue: T) => {
  const [value, setValue] = useState(initialValue);
  return { value, setValue };
};
```

### Runtime Patterns

```typescript
// Constructor-based initialization
const block = new TimerBlock(config);  // Init here
stack.push(block);                      // Only registration

// Consumer-managed disposal
runtime.popBlock();  // Includes automatic dispose
```

## Module-Specific Guidelines

### Runtime Module

- Document lifecycle methods (mount, next, unmount, dispose)
- Note performance requirements (< 1ms for push/pop, < 50ms for dispose)
- Document behavior composition pattern
- Include memory allocation patterns

### Editor Module

- Document Monaco integration details
- Include token types and colors
- Document suggestion provider interfaces
- Note performance considerations for highlighting

### Parser Module

- Document grammar rules with examples
- Include token definitions
- Show parse tree structure
- Document error format

### Fragment Module

- Document all fragment types
- Include collection states
- Show parsing examples
- Note fragment-to-block mapping

## Writing Style

- **Voice**: Active, present tense ("Creates a timer", not "Timer is created")
- **Tone**: Clear, concise, professional
- **Clarity**: Avoid jargon when possible, explain technical terms
- **Completeness**: Document all parameters, returns, and side effects
- **Consistency**: Use same terminology across documentation

## Common Pitfalls to Avoid

1. **Don't** - Assume implementation details not visible in the code
2. **Don't** - Document internal/private methods unless necessary
3. **Don't** - Use "TODO" in generated docs - flag for manual review instead
4. **Don't** - Skip documenting error handling paths
5. **Don't** - Forget to document null/undefined cases
6. **Do** - Cross-reference existing documentation when available
7. **Do** - Preserve documentation structure consistency
8. **Do** - Include practical examples from actual code usage
9. **Do** - Extract inline docstrings as foundation
10. **Do** - Use placeholder "TODO: Add description" when purpose is unclear

## Existing Documentation to Reference

- [AGENTS.md](../AGENTS.md) - Development guidelines (primary reference)
- [README.md](../README.md) - Project overview
- [block-types-behaviors-reference.md](../block-types-behaviors-reference.md) - Detailed runtime reference
- [runtime-action-lifecycle.md](../runtime-action-lifecycle.md) - Lifecycle patterns

## Code Examples Style

```typescript
// Always include imports in examples
import { WodWiki } from '@/editor/WodWiki';
import { useClock } from '@/hooks/useClock';

// Use descriptive variable names
const workoutTimer = useClock();
const [elapsed, setElapsed] = useState(0);

// Show complete, runnable examples
function handleStart() {
  workoutTimer.start();
  setElapsed(0);
}
```

## Type Definitions

For complex types, use:

```typescript
interface ComplexType {
  // Required property
  id: string;
  
  // Optional property
  name?: string;
  
  // Union type
  status: 'pending' | 'active' | 'complete';
  
  // Generic parameter
  data<T>(key: string): T;
}
```

## Update Policy

When updating documentation:
1. Review existing docs before adding
2. Maintain consistency with existing style
3. Update cross-references when adding new sections
4. Update this file with new patterns discovered
5. Add module-specific guidelines for new modules

## Generated Documentation Files

Current generated documentation:
- [index.md](./index.md) - Main documentation index
- [runtime-system.md](./runtime-system.md) - Runtime engine and execution
- [fragment-types.md](./fragment-types.md) - Parsed component types
- [parser-system.md](./parser-system.md) - Workout script parsing
- [editor-integration.md](./editor-integration.md) - Monaco editor features
- [services.md](./services.md) - Shared services and utilities
- [clock-timer.md](./clock-timer.md) - Timer components and utilities

## Quick Reference

### Common TypeScript Patterns

| Pattern | Example | Description |
|---------|---------|-------------|
| Interface props | `interface Props { value: string }` | Define component props |
| Optional param | `name?: string` | Mark optional with `?` |
| Union type | `type: 'up' | 'down'` | Type with fixed values |
| Generic function | `function<T>(data: T): T` | Generic parameter and return |

### Common React Patterns

| Pattern | Example | Description |
|---------|---------|-------------|
| useState hook | `const [val, setVal] = useState(initial)` | State management |
| useEffect hook | `useEffect(() => {}, [deps])` | Side effects |
| useMemo hook | `useMemo(() => compute(), [deps])` | Memoization |
| useCallback hook | `useCallback(fn, [deps])` | Stable references |

### Common Runtime Patterns

| Pattern | Example | Description |
|---------|---------|-------------|
| Block initialization | `new Block(config)` | Init in constructor |
| Stack operation | `runtime.pushBlock(block)` | Push to execution |
| Memory allocation | `memory.allocate(type, id, val)` | Allocate typed memory |
| Event dispatch | `eventBus.dispatch({type, data})` | Publish event |
