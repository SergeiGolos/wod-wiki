## 00:14 - Plan Improve Edit Mode UX

1.  Analyze `EditableMetricCell.tsx` to understand structure and styling.
2.  Refine CSS in `EditableMetricCell.tsx` to fix layout shift and border appearance.
3.  Add visual cancellation feedback (e.g., background change, icon, Esc key listener) to `EditableMetricCell.tsx`.

### Summary

The goal is to make the inline editing experience in the `EventsView` table smoother by eliminating layout shifts, improving the visual style of the editing cell, and clearly indicating how to cancel the edit.

Made the inline editing experience smoother by:
*   Using `outline` instead of `border` on the input to prevent layout shifts.
*   Ensuring consistent padding (`px-1 py-0`) in both display and edit modes.
*   Adding a `bg-blue-50` background hint to the input during editing for better visual feedback.
*   Leveraged existing 'Escape' key handling for cancellation.

Made debugging changes:
*   Added `console.log` in `EventsView` to inspect event data.
*   Restored `min-h` on the display `span` in `EditableMetricCell` for clickability.
*   Temporarily removed `w-full` from the `input` in `EditableMetricCell` to check sizing.
Attempted to fix input sizing by forcing box-sizing and max-width. Waiting for user feedback on console logs to diagnose missing resistance/distance values.

Shifted focus to look and feel:
*   Set a fixed width (`w-20`) for the input in `EditableMetricCell`.
*   Removed the outline.
*   Using background color (`bg-gray-100` for editing, `bg-red-100` for error) as the visual indicator.

Addressed focus issue:
*   Simplified `handleBlur` in `EditableMetricCell` by removing `setTimeout` to prevent race conditions.
*   Used `requestAnimationFrame` in focus `useEffect` for more reliable focus timing.

Added detailed console logging to `EditableMetricCell` event handlers (`onClick`, `onBlur`, `onKeyDown`, `handleAttemptSave`, `handleCancel`) and state changes (`useEffect` for `isEditing`) to trace focus issues. Reintroduced a short delay (100ms) to `onBlur` as part of debugging.

### Completed Steps

*   [x]: 00:14 - Created initial plan.
*   [x]: 00:16 - Analyzed `EditableMetricCell.tsx`. Identified causes for layout shift (border, padding differences) and lack of cancel feedback.
*   [x]: 00:18 - Applied CSS changes to `EditableMetricCell.tsx` (used outline, consistent padding, background hint).
*   [x]: 00:20 - Added console log to `EventsView.tsx` for data inspection.
*   [x]: 00:20 - Restored `min-h` to span and removed `w-full` from input in `EditableMetricCell.tsx` for debugging.
*   [x]: 00:24 - Applied `box-sizing: border-box` and `max-width: 100%` to input in `EditableMetricCell.tsx` to further address sizing.
*   [x]: 00:26 - Applied new styling to input: fixed width (`w-20`), removed outline, background color indicates edit state (`bg-gray-100`/`bg-red-100`).
*   [x]: 00:28 - Refined focus logic: Removed `setTimeout` from `onBlur`, used `rAF` in focus `useEffect`.
*   [x]: 00:30 - Added detailed console logging to `EditableMetricCell.tsx` for focus/event tracing.

### Next Steps

*   [ ]: 00:30 - User to perform click-out/click-in sequence and provide console log output.
